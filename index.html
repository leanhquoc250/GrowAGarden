<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grow A Garden — Phiên bản đầy đủ</title>
  <style>
    :root{
      --bg:#f5fff6; --panel:#ffffff; --accent:#3fb373; --muted:#5e6b5e;
      --glass: rgba(255,255,255,0.6);
    }
    *{box-sizing:border-box}
    body{font-family:Inter, "Segoe UI", Roboto, Arial; margin:0; background:linear-gradient(180deg,#eaffef,#f8fff9); color:#07321b}
    header{padding:18px; display:flex; align-items:center; gap:12px}
    h1{font-size:20px; margin:0}
    .container{display:flex; gap:18px; padding:18px; align-items:flex-start; max-width:1200px; margin:0 auto}
    .left{width:680px}
    .right{flex:1; min-width:300px}
    .panel{background:var(--panel); border-radius:14px; padding:14px; box-shadow:0 8px 24px rgba(9,36,19,0.06)}
    .grid{display:grid; grid-template-columns:repeat(8,1fr); gap:10px; padding:12px; background:linear-gradient(180deg, rgba(255,255,255,0.4), rgba(255,255,255,0.6)); border-radius:10px}
    .tile{background:linear-gradient(180deg,#f0fbf3,#e6f9ea); height:84px; border-radius:10px; display:flex; align-items:center; justify-content:center; cursor:pointer; position:relative; border:1px solid rgba(6,30,15,0.06)}
    .tile.locked{opacity:0.45; filter:grayscale(0.2); cursor:not-allowed}
    .tile .stage{font-size:28px}
    .bar{height:8px; background:#e9f6ed; border-radius:6px; overflow:hidden; width:86%; margin:6px auto 0; box-shadow:inset 0 -2px 0 rgba(0,0,0,0.03)}
    .bar > i{display:block; height:100%; background:linear-gradient(90deg,var(--accent),#6bd38b); width:0%}
    .controls{display:flex; gap:8px; margin-top:10px; flex-wrap:wrap}
    button{background:var(--accent); color:white; padding:8px 12px; border:none; border-radius:10px; cursor:pointer; font-weight:600}
    button.secondary{background:#fff; color:var(--accent); border:1px solid rgba(63,179,115,0.14)}
    .resource{display:flex; gap:12px; align-items:center; margin-bottom:6px}
    .shop-item{display:flex; justify-content:space-between; gap:8px; padding:10px; border-radius:10px; align-items:center; border:1px solid rgba(6,30,15,0.03); margin-bottom:8px}
    .muted{color:var(--muted); font-size:13px}
    .badge{background:#fff; border-radius:8px; padding:6px 8px; border:1px solid rgba(6,30,15,0.06); font-weight:700}
    .inventory-list{display:flex; gap:8px; flex-direction:column}
    .flex{display:flex; gap:8px; align-items:center}
    footer{padding:12px; text-align:center; color:var(--muted)}
    .topbar{display:flex; justify-content:space-between; gap:12px; align-items:center}
    .seed-btn{background:linear-gradient(180deg,#fff,#f6fff8); border-radius:8px; padding:6px 8px; border:1px solid rgba(6,30,15,0.04); cursor:pointer}
    .selected{outline:3px solid rgba(63,179,115,0.18)}
    /* small screens */
    @media(max-width:980px){.container{flex-direction:column}.left{width:100%}}
    /* cute SVG icon sizing */
    .icon{width:40px;height:40px;display:inline-block;vertical-align:middle}
  </style>
</head>
<body>
  <header>
    <h1>🌼 Grow A Garden — Full (Cute Edition)</h1>
    <div style="margin-left:auto; color:var(--muted); font-size:13px">Lưu: localStorage • Mở file trực tiếp</div>
  </header>

  <div class="container">
    <div class="left panel">
      <div class="topbar">
        <div>
          <div class="resource"><strong>Tiền:</strong> <span id="money">0</span> ₫</div>
          <div class="resource"><strong>Hạt (Thường):</strong> <span id="seeds_basic">0</span> &nbsp; <strong>Hạt (Quý):</strong> <span id="seeds_premium">0</span></div>
        </div>
        <div style="text-align:right">
          <div class="muted">Thời gian: <span id="time">0</span>s</div>
          <div class="muted">Tốc độ: <span id="speed">1x</span></div>
        </div>
      </div>

      <div style="margin-top:12px" id="gardenWrap">
        <div class="grid" id="garden"></div>
      </div>

<div class="controls" style="margin-top:12px">
  <button id="plantBtn">🌱 Trồng</button>
  <button id="plantAllBtn" class="secondary">🌱 Trồng tất cả</button>
  <button id="waterBtn" class="secondary">💧 Tưới</button>
  <button id="harvestBtn" class="secondary">🧺 Thu hoạch</button>
  <button id="harvestAllBtn" class="secondary">🧺 Thu hoạch tất cả</button>
  <button id="storeHarvestBtn" class="secondary">📦 Lưu vào kho</button>
  <button id="buyTileBtn" class="secondary">🛒 Mua ô mới (200₫)</button>
  <button id="skipBtn" class="secondary">⏭️ +5s</button>
</div>



      <div style="margin-top:10px; font-size:13px; color:var(--muted)">
        Hướng dẫn ngắn: Chọn ô → Chọn loại hạt ở bên phải → Nhấn Trồng. Thu hoạch sẽ đưa trái cây vào kho, dùng Shop → Sell để bán.
      </div>
    </div>

    <div class="right">
      <div class="panel">
        <h3 style="margin-top:0">Shop — Mua hạt & Gear</h3>

        <div style="display:flex; gap:8px; margin-bottom:10px; align-items:center;">
          <button id="select_basic" class="seed-btn selected">🌱 Hạt Thường<br/><span class="muted">Giá mua: 20₫</span></button>
          <button id="select_premium" class="seed-btn">🌸 Hạt Quý<br/><span class="muted">Giá mua: 120₫</span></button>
        </div>

        <div class="shop-item">
          <div><strong>Mua Hạt Thường</strong><div class="muted">+1 hạt thường (20₫)</div></div>
          <div><button id="buy_basic">Mua 20₫</button></div>
        </div>

        <div class="shop-item">
          <div><strong>Mua Hạt Quý</strong><div class="muted">+1 hạt quý (120₫)</div></div>
          <div><button id="buy_premium">Mua 120₫</button></div>
        </div>

        <hr style="border:none;height:8px">

        <h4>Gear (cải tiến)</h4>
        <div class="shop-item">
          <div><strong>Bình tưới xịn</strong><div class="muted">Tăng 20% hiệu quả tưới (tích lũy)</div></div>
          <div><button id="buy_sprayer">Mua 250₫</button></div>
        </div>

        <div class="shop-item">
          <div><strong>Cuốc xịn</strong><div class="muted">Tăng 20% giá bán trái cây</div></div>
          <div><button id="buy_shovel">Mua 350₫</button></div>
        </div>

        <hr style="border:none;height:8px">

        <h4>Kho trái cây</h4>
        <div class="inventory-list" id="inventoryBox">
          <div class="flex"><div style="flex:1">Quả Thường</div><div class="badge" id="fruit_basic">0</div></div>
          <div class="flex"><div style="flex:1">Quả Quý</div><div class="badge" id="fruit_premium">0</div></div>
        </div>

        <div style="margin-top:10px" class="flex">
          <button id="sellAllBtn">💰 Bán tất cả</button>
          <div class="muted" style="margin-left:auto">Giá: Quả Thường 80₫, Quả Quý 320₫</div>
        </div>
      </div>

      <div class="panel" style="margin-top:12px">
        <h3 style="margin-top:0">Chi tiết ô</h3>
        <div id="tileInfo">Chọn một ô để xem thông tin</div>
      </div>
    </div>
  </div>

  <footer class="panel">Làm vì Rảnh:) — Phiên bản đầy đủ. Mở file trực tiếp trong trình duyệt.</footer>

<script>
/* --- CONFIG --- */
const CONFIG = {
  rows:4, cols:8,
  initialUnlocked:12,
  growBaseTime_basic: 22,      // seconds for basic seed
  growBaseTime_premium: 48,    // seconds for premium seed
  sell_price_basic: 80,
  sell_price_premium: 320,
  seed_price_basic: 20,
  seed_price_premium: 120,
  sprayer_price: 250,
  shovel_price: 350,
  start_money: 500,
  start_seeds_basic: 5,
  start_seeds_premium: 0
};

/* --- STATE --- */
const state = {
  money: CONFIG.start_money,
  seeds_basic: CONFIG.start_seeds_basic,
  seeds_premium: CONFIG.start_seeds_premium,
  time: 0,
  speed: 1.0,
  sprayerLevel: 0, // each level +0.2 watering efficiency
  shovelLevel: 0,  // each level +0.2 sell bonus
  unlockedTiles: CONFIG.initialUnlocked,
  tiles: [], // {locked, planted, seedType, progress}
  inventory: { fruit_basic:0, fruit_premium:0 },
  selectedSeedType: 'basic',
  selectedTile: null
};

/* --- INIT TILES --- */
const total = CONFIG.rows * CONFIG.cols;
for(let i=0;i<total;i++){
  state.tiles.push({ locked: i >= state.unlockedTiles, planted:false, seedType:null, progress:0, plantedAt:0 });
}

/* --- DOM --- */
const garden = document.getElementById('garden');
const moneyEl = document.getElementById('money');
const seedsBasicEl = document.getElementById('seeds_basic');
const seedsPremiumEl = document.getElementById('seeds_premium');
const timeEl = document.getElementById('time');
const speedEl = document.getElementById('speed');
const tileInfo = document.getElementById('tileInfo');
const fruitBasicEl = document.getElementById('fruit_basic');
const fruitPremiumEl = document.getElementById('fruit_premium');

/* seed select buttons */
const selBasicBtn = document.getElementById('select_basic');
const selPremiumBtn = document.getElementById('select_premium');

selBasicBtn.addEventListener('click', ()=>{
  state.selectedSeedType = 'basic';
  selBasicBtn.classList.add('selected');
  selPremiumBtn.classList.remove('selected');
});
selPremiumBtn.addEventListener('click', ()=>{
  state.selectedSeedType = 'premium';
  selPremiumBtn.classList.add('selected');
  selBasicBtn.classList.remove('selected');
});

/* --- RENDER GRID --- */
function renderGrid(){
  garden.innerHTML = '';
  state.tiles.forEach((t,i)=>{
    const div = document.createElement('div');
    div.className = 'tile' + (t.locked ? ' locked' : '');
    div.dataset.index = i;

    if(t.locked){
      div.innerHTML = '<div style="text-align:center;color:var(--muted)"><svg class="icon" viewBox="0 0 24 24"><path fill="#9fbf9f" d="M12 2C9.79 2 8 3.79 8 6v2H6a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V10a2 2 0 00-2-2h-2V6c0-2.21-1.79-4-4-4zM10 8V6a2 2 0 114 0v2h-4z"/></svg><div style="font-size:12px">Khóa</div></div>';
    } else if(!t.planted){
      div.innerHTML = '<div style="text-align:center"><svg class="icon" viewBox="0 0 24 24"><path fill="#3fb373" d="M12 2C10 6 6 7 6 12a6 6 0 0012 0c0-5-4-6-6-10z"/></svg></div>';
    } else {
      const p = t.progress;
      let emoji = '🌱', label='Trồng';
      if(t.seedType === 'basic'){ label='Hạt Thường'; }
      else { label='Hạt Quý'; }
      if(p < 0.25) emoji='🌱';
      else if(p < 0.6) emoji='🌿';
      else if(p < 0.95) emoji='🌼';
      else emoji='🌻';
      div.innerHTML = `<div style="text-align:center"><div class="stage">${emoji}</div><div style="font-size:12px;color:var(--muted)">${label}</div><div class="bar"><i style="width:${Math.round(p*100)}%"></i></div></div>`;
    }

    if(state.selectedTile === i) div.classList.add('selected');
    div.addEventListener('click', ()=>onTileClick(i));
    garden.appendChild(div);
  });
}

/* --- TILE CLICK --- */
function onTileClick(i){
  state.selectedTile = i;
  showTileInfo(i);
  renderGrid();
}

/* --- SHOW TILE INFO --- */
function showTileInfo(i){
  const t = state.tiles[i];
  if(!t) { tileInfo.innerHTML = 'Không tìm thấy ô.'; return; }
  if(t.locked){
    tileInfo.innerHTML = `<strong>Ô ${i+1} (Khóa)</strong><div class="muted">Mua mở ô trong Shop.</div>`;
  } else if(!t.planted){
    tileInfo.innerHTML = `<strong>Ô ${i+1}</strong><div>Trống — chọn hạt và nhấn Trồng.</div>`;
  } else {
    const remain = Math.max(0, Math.ceil((1 - t.progress) * getGrowTime(t.seedType)));
    tileInfo.innerHTML = `<strong>Ô ${i+1}</strong><div>Loại: ${t.seedType === 'basic' ? 'Hạt Thường' : 'Hạt Quý'}</div><div>Tiến trình: ${Math.round(t.progress*100)}%</div><div>Thời gian còn: ${remain}s</div>`;
  }
}

/* --- GROW TIME --- */
function getGrowTime(seedType){
  if(seedType === 'basic') return CONFIG.growBaseTime_basic / state.speed;
  return CONFIG.growBaseTime_premium / state.speed;
}

/* --- CONTROLS --- */
document.getElementById('plantBtn').addEventListener('click', ()=>{
  const i = state.selectedTile;
  if(i === null){ alert('Chọn ô trước khi trồng.'); return; }
  const t = state.tiles[i];
  if(t.locked){ alert('Ô đang khóa.'); return; }
  if(t.planted){ alert('Ô đã có cây.'); return; }
  // check seed
  if(state.selectedSeedType === 'basic'){
    if(state.seeds_basic <= 0){ alert('Không có hạt thường. Mua trong shop.'); return; }
    state.seeds_basic -= 1;
    t.planted = true; t.seedType='basic'; t.progress=0; t.plantedAt = state.time;
  } else {
    if(state.seeds_premium <= 0){ alert('Không có hạt quý. Mua trong shop.'); return; }
    state.seeds_premium -= 1;
    t.planted = true; t.seedType='premium'; t.progress=0; t.plantedAt = state.time;
  }
  playSound('plant');
  save(); renderAll();
});

document.getElementById('waterBtn').addEventListener('click', ()=>{
  const i = state.selectedTile;
  if(i === null){ alert('Chọn ô để tưới.'); return; }
  const t = state.tiles[i];
  if(t.locked || !t.planted){ alert('Ô không có cây để tưới.'); return; }
  const efficiency = 0.12 * (1 + state.sprayerLevel * 0.20); // base 12%
  t.progress = Math.min(1, t.progress + efficiency);
  playSound('water');
  save(); renderAll();
});

document.getElementById('harvestBtn').addEventListener('click', ()=>{
  const i = state.selectedTile;
  if(i === null){ alert('Chọn ô để thu hoạch.'); return; }
  const t = state.tiles[i];
  if(t.locked || !t.planted){ alert('Ô không có cây để thu hoạch.'); return; }
  if(t.progress < 0.95){ alert('Cây chưa chín đủ.'); return; }
  // when harvesting, store fruit into inventory instead of adding money
  if(t.seedType === 'basic') state.inventory.fruit_basic += 1;
  else state.inventory.fruit_premium += 1;
  t.planted = false; t.progress = 0; t.seedType = null;
  playSound('harvest');
  save(); renderAll();
});

document.getElementById('storeHarvestBtn').addEventListener('click', ()=>{
  // shortcut: if tile is ripe, store into inventory
  const i = state.selectedTile;
  if(i === null){ alert('Chọn ô.'); return; }
  const t = state.tiles[i];
  if(t.locked || !t.planted){ alert('Ô không có cây.'); return; }
  if(t.progress < 0.95){ alert('Cây chưa chín đủ.'); return; }
  if(t.seedType === 'basic') state.inventory.fruit_basic += 1;
  else state.inventory.fruit_premium += 1;
  t.planted = false; t.progress = 0; t.seedType = null;
  playSound('harvest');
  save(); renderAll();
});

document.getElementById('skipBtn').addEventListener('click', ()=>{
  state.time += 5;
  simulateProgress(5);
  save(); renderAll();
});

/* BUY ITEMS */
document.getElementById('buy_basic').addEventListener('click', ()=>{
  if(state.money < CONFIG.seed_price_basic){ alert('Không đủ tiền.'); return; }
  state.money -= CONFIG.seed_price_basic; state.seeds_basic += 1;
  playSound('buy');
  save(); renderAll();
});
document.getElementById('buy_premium').addEventListener('click', ()=>{
  if(state.money < CONFIG.seed_price_premium){ alert('Không đủ tiền.'); return; }
  state.money -= CONFIG.seed_price_premium; state.seeds_premium += 1;
  playSound('buy');
  save(); renderAll();
});
document.getElementById('buy_sprayer').addEventListener('click', ()=>{
  if(state.money < CONFIG.sprayer_price){ alert('Không đủ tiền.'); return; }
  state.money -= CONFIG.sprayer_price; state.sprayerLevel += 1;
  playSound('buy');
  save(); renderAll();
});
document.getElementById('buy_shovel').addEventListener('click', ()=>{
  if(state.money < CONFIG.shovel_price){ alert('Không đủ tiền.'); return; }
  state.money -= CONFIG.shovel_price; state.shovelLevel += 1;
  playSound('buy');
  save(); renderAll();
});

/* SELL ALL */
document.getElementById('sellAllBtn').addEventListener('click', ()=>{
  const basic = state.inventory.fruit_basic;
  const premium = state.inventory.fruit_premium;
  if(basic === 0 && premium === 0){ alert('Kho trống.'); return; }
  let total = 0;
  let bonus = 1 + state.shovelLevel * 0.20;
  total += basic * CONFIG.sell_price_basic * bonus;
  total += premium * CONFIG.sell_price_premium * bonus;
  state.money += Math.round(total);
  state.inventory.fruit_basic = 0;
  state.inventory.fruit_premium = 0;
  playSound('sell');
  save(); renderAll();
});

/* --- SIMULATION --- */
function simulateProgress(deltaSec){
  // increase progress based on time passed
  state.tiles.forEach(t=>{
    if(!t.locked && t.planted){
      const growTime = getGrowTime(t.seedType);
      const dt = deltaSec / growTime;
      t.progress = Math.min(1, t.progress + dt);
    }
  });
}

/* game clock */
setInterval(()=>{
  state.time += 1;
  simulateProgress(1);
  save(); renderAll();
}, 1000);

/* --- RENDER --- */
function renderAll(){
  renderGrid();
  moneyEl.innerText = state.money;
  seedsBasicEl.innerText = state.seeds_basic;
  seedsPremiumEl.innerText = state.seeds_premium;
  timeEl.innerText = state.time;
  speedEl.innerText = state.speed.toFixed(2) + 'x';
  fruitBasicEl.innerText = state.inventory.fruit_basic;
  fruitPremiumEl.innerText = state.inventory.fruit_premium;
  if(state.selectedTile !== null) showTileInfo(state.selectedTile);
}

/* --- SAVE / LOAD --- */
const SAVE_KEY = 'grow_a_garden_full_v1';
function save(){
  try{
    localStorage.setItem(SAVE_KEY, JSON.stringify(state));
  }catch(e){ console.warn('Save failed', e); }
}
function load(){
  try{
    const raw = localStorage.getItem(SAVE_KEY);
    if(!raw) return;
    const s = JSON.parse(raw);
    // copy fields carefully
    state.money = s.money ?? state.money;
    state.seeds_basic = s.seeds_basic ?? state.seeds_basic;
    state.seeds_premium = s.seeds_premium ?? state.seeds_premium;
    state.time = s.time ?? state.time;
    state.speed = s.speed ?? state.speed;
    state.sprayerLevel = s.sprayerLevel ?? state.sprayerLevel;
    state.shovelLevel = s.shovelLevel ?? state.shovelLevel;
    state.unlockedTiles = s.unlockedTiles ?? state.unlockedTiles;
    if(Array.isArray(s.tiles) && s.tiles.length === state.tiles.length){
      state.tiles = s.tiles;
    }
    state.inventory = s.inventory ?? state.inventory;
    state.selectedSeedType = s.selectedSeedType ?? state.selectedSeedType;
    state.selectedTile = s.selectedTile ?? state.selectedTile;
  }catch(e){ console.warn('Load failed', e); }
}

/* --- sounds via WebAudio --- */
const AudioCtx = window.AudioContext || window.webkitAudioContext;
let audioCtx = null;
function ensureAudio(){
  if(!audioCtx) audioCtx = new AudioCtx();
}
function playTone(freq, duration=0.08, type='sine'){
  try{
    ensureAudio();
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = type; o.frequency.value = freq;
    o.connect(g); g.connect(audioCtx.destination);
    g.gain.setValueAtTime(0.0001, audioCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.2, audioCtx.currentTime + 0.01);
    o.start();
    g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
    o.stop(audioCtx.currentTime + duration + 0.02);
  }catch(e){}
}
function playSound(name){
  if(name === 'water'){ playTone(880,0.06,'triangle'); }
  else if(name === 'harvest'){ playTone(660,0.09,'sine'); playTone(880,0.06,'sine'); }
  else if(name === 'plant'){ playTone(520,0.06,'sine'); }
  else if(name === 'buy'){ playTone(740,0.05,'square'); }
  else if(name === 'sell'){ playTone(440,0.12,'sine'); playTone(660,0.06,'sine'); }
}

/* --- UTIL: clear save (for dev) --- */
window.clearSave = function(){ localStorage.removeItem(SAVE_KEY); location.reload(); };

// Thu hoạch tất cả ô đã chín
document.getElementById('harvestAllBtn').addEventListener('click', ()=>{
  let harvested = 0;
  state.tiles.forEach(t=>{
    if(!t.locked && t.planted && t.progress >= 0.95){
      if(t.seedType === 'basic') state.inventory.fruit_basic++;
      else state.inventory.fruit_premium++;
      t.planted = false;
      t.progress = 0;
      t.seedType = null;// Thu hoạch tất cả ô đã chín
document.getElementById('harvestAllBtn').addEventListener('click', ()=>{
  let harvested = 0;
  state.tiles.forEach(t=>{
    if(!t.locked && t.planted && t.progress >= 0.95){
      if(t.seedType === 'basic') state.inventory.fruit_basic++;
      else state.inventory.fruit_premium++;
      t.planted = false;
      t.progress = 0;
      t.seedType = null;
      harvested++;
    }
  });
  if(harvested === 0){
    alert('Không có cây nào đã chín.');
    return;
  }
  playSound('harvest');
  save(); renderAll();
});

// Mua ô mới giá 200₫
document.getElementById('buyTileBtn').addEventListener('click', ()=>{
  const price = 200;
  if(state.money < price){
    alert('Không đủ tiền để mua ô mới.');
    return;
  }
  const lockedIndex = state.tiles.findIndex(t=>t.locked);
  if(lockedIndex === -1){
    alert('Tất cả ô đã được mở.');
    return;
  }
  state.money -= price;
  state.tiles[lockedIndex].locked = false;
  state.unlockedTiles++;
  playSound('buy');
  save(); renderAll();
});

      harvested++;
    }
  });
  if(harvested === 0){
    alert('Không có cây nào đã chín.');
    return;
  }
  playSound('harvest');
  save(); renderAll();
});

// Mua ô mới giá 200₫
document.getElementById('buyTileBtn').addEventListener('click', ()=>{
  const price = 200;
  if(state.money < price){
    alert('Không đủ tiền để mua ô mới.');
    return;
  }
  const lockedIndex = state.tiles.findIndex(t=>t.locked);
  if(lockedIndex === -1){
    alert('Tất cả ô đã được mở.');
    return;
  }
  state.money -= price;
  state.tiles[lockedIndex].locked = false;
  state.unlockedTiles++;
  playSound('buy');
  save(); renderAll();
});

// Trồng tất cả ô trống bằng loại hạt đang chọn
document.getElementById('plantAllBtn').addEventListener('click', ()=>{
  let planted = 0;
  state.tiles.forEach(t=>{
    if(!t.locked && !t.planted){
      if(state.selectedSeedType === 'basic' && state.seeds_basic > 0){
        state.seeds_basic--;
        t.planted = true;
        t.seedType = 'basic';
        t.progress = 0;
        t.plantedAt = state.time;
        planted++;
      }
      else if(state.selectedSeedType === 'premium' && state.seeds_premium > 0){
        state.seeds_premium--;
        t.planted = true;
        t.seedType = 'premium';
        t.progress = 0;
        t.plantedAt = state.time;
        planted++;
      }
    }
  });
  if(planted === 0){
    alert('Không còn ô trống hoặc không đủ hạt.');
    return;
  }
  playSound('plant');
  save(); renderAll();
});



/* --- initial load & first render --- */
load();
renderAll();
</script>
</body>
</html>
